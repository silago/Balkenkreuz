[gd_scene load_steps=5 format=2]

[ext_resource path="res://Prefabs/Enemy.tscn" type="PackedScene" id=1]
[ext_resource path="res://Prefabs/Rocket.tscn" type="PackedScene" id=2]
[ext_resource path="res://Prefabs/Zeppelin.tscn" type="PackedScene" id=3]

[sub_resource type="GDScript" id=1]
script/source = "extends Node

export(PackedScene) var PlaneEnemy
export(PackedScene) var Rocket
export(PackedScene) var Zeppelin

export var spawn_timeout = 2
var pos : Vector2


func _ready():
    #print(\"UI READY\")
    var fr = funcref(self,\"on_player_position_changed\")
    EventManager.subscribe(EventManager.EVENTS.PLAYER_POSITION_CHANGED,fr)
    connect(\"tree_exited\",EventManager,\"unsubscribe\",[EventManager.EVENTS.PLAYER_POSITION_CHANGED,fr])
    #print(\"!!!\")
func on_player_position_changed(args):
    pos = args['position']
    #print(\"!!\")
    
func spawn(prefab):
    yield(get_tree().create_timer(spawn_timeout),\"timeout\")
    var instance = prefab.instance() as Node2D
    Game.root_node.add_child(instance)
    instance.global_position = pos
    
func _on_SpawnPlane_button_up():
    spawn(PlaneEnemy)

func _on_SpawnZeppelin_button_up():
    spawn(Zeppelin)


func _on_SpawnRocket_button_up():
    spawn(Rocket)"

[node name="Debug" type="CanvasLayer"]

[node name="Debug" type="Control" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 1 )
PlaneEnemy = ExtResource( 1 )
Rocket = ExtResource( 2 )
Zeppelin = ExtResource( 3 )

[node name="SpawnPlane" type="Button" parent="Debug"]
margin_right = 91.0
margin_bottom = 20.0
rect_pivot_offset = Vector2( 30, -10 )
text = "Spawn Plane"

[node name="SpawnZeppelin" type="Button" parent="Debug"]
margin_top = 30.0
margin_right = 91.0
margin_bottom = 50.0
rect_pivot_offset = Vector2( 30, -10 )
text = "Spawn Zeppelin"

[node name="SpawnRocket" type="Button" parent="Debug"]
margin_top = 60.0
margin_right = 91.0
margin_bottom = 80.0
rect_pivot_offset = Vector2( 30, -10 )
text = "Spawn Rocket"

[connection signal="button_up" from="Debug/SpawnPlane" to="Debug" method="_on_SpawnPlane_button_up"]
[connection signal="button_up" from="Debug/SpawnZeppelin" to="Debug" method="_on_SpawnZeppelin_button_up"]
[connection signal="button_up" from="Debug/SpawnRocket" to="Debug" method="_on_SpawnRocket_button_up"]
